<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Typing Game 20 Parts with Secret Admin Panel</title>
<style>
  @keyframes backgroundAnimation {
    0%, 100% {background-position: 0% 50%; }
    50% {background-position: 100% 50%; }
  }
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: linear-gradient(-45deg, #1e3c72, #2a5298, #335d99, #1e3c72);
    background-size: 400% 400%;
    animation: backgroundAnimation 25s ease infinite;
    overflow: hidden;
  }
  body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: repeating-radial-gradient(circle, rgba(255,255,255,0.02) 0, rgba(255,255,255,0.02) 1px, transparent 1px, transparent 30px);
    pointer-events: none;
    z-index: 0;
  }
  .container {
    background: #fff;
    padding: 35px 40px 80px;
    border-radius: 20px;
    width: 720px;
    max-width: 95vw;
    box-shadow: 0 25px 50px rgb(0 0 0 / 0.3);
    position: relative;
    color: #222;
    z-index: 1;
  }
  #stage {
    font-size: 28px;
    font-weight: 700;
    margin-bottom: 18px;
    user-select: none;
  }
  #timer {
    font-size: 22px;
    font-weight: 600;
    text-align: right;
    margin-bottom: 18px;
    user-select: none;
    color: #444;
  }
  .progress-bar {
    background: #ddd;
    border-radius: 12px;
    height: 12px;
    width: 100%;
    margin-bottom: 32px;
    overflow: hidden;
    box-shadow: inset 0 2px 8px rgb(0 0 0 / 0.1);
  }
  .bar {
    background: #4a90e2;
    height: 100%;
    border-radius: 12px 0 0 12px;
    width: 0%;
    box-shadow: 0 0 10px #4a90e2aa;
    transition: width 0.3s ease;
  }
  #text {
    font-size: 26px;
    line-height: 1.5;
    min-height: 110px;
    border: 2.5px solid #bbb;
    padding: 24px 28px;
    border-radius: 20px;
    background: #fafafa;
    box-shadow: inset 0 3px 10px rgb(0 0 0 / 0.08);
    letter-spacing: 1.4px;
    user-select: none;
    white-space: pre-wrap;
    margin-bottom: 35px;
  }
  .correct {
    color: #2ecc40;
    background: #e1f7d5;
    border-radius: 6px;
    transition: background 0.3s ease;
  }
  .wrong {
    color: #e74c3c;
    background: #fdecea;
    border-radius: 6px;
    transition: background 0.3s ease;
  }
  #input {
    width: 100%;
    height: 80px;
    font-size: 22px;
    font-family: monospace;
    padding: 20px 22px;
    border-radius: 20px;
    border: 2.5px solid #999;
    box-shadow: 0 5px 18px rgb(0 0 0 / 0.1);
    resize: none;
    outline-offset: 3px;
    outline-color: #4a90e2;
    color: #212121;
  }
  #input:focus {
    border-color: #4a90e2;
    box-shadow: 0 0 12px #4a90e2bb;
  }
  button {
    width: 170px;
    padding: 16px 0;
    font-size: 20px;
    font-weight: 700;
    border-radius: 25px;
    border: none;
    margin-top: 24px;
    cursor: pointer;
    background: #4a90e2;
    color: #fff;
    box-shadow: 0 10px 20px #2f65bfaa;
    transition: background 0.3s ease, box-shadow 0.3s ease;
  }
  button:hover {
    background: #3b73ba;
    box-shadow: 0 14px 26px #2a5bb0cc;
  }
  #secretInput {
    position: fixed;
    bottom: 10px;
    left: 10px;
    padding: 6px 12px;
    font-size: 14px;
    letter-spacing: 1.6px;
    border-radius: 12px;
    font-family: monospace;
    width: 260px;
    border: 1.8px solid #ccc;
    z-index: 50;
    box-sizing: border-box;
    color: #666;
  }
  #secretPanel {
    position: fixed;
    bottom: 80px;
    left: 10px;
    background: #273c75ee;
    padding: 20px 32px;
    border-radius: 24px;
    box-shadow: 0 12px 30px rgba(0,0,0,0.7);
    width: 320px;
    text-align: center;
    color: white;
    user-select: none;
    z-index: 51;
    display: none;
  }
  #secretPanel button, #secretPanel input {
    margin-top: 12px;
    border-radius: 20px;
    font-size: 18px;
    padding: 10px 0;
    width: 100%;
    border: none;
    outline: none;
    cursor: pointer;
    box-shadow: 0 6px 16px rgba(0,0,0,0.25);
  }
  #secretPanel input {
    padding-left: 20px;
    font-family: monospace;
    color: #333;
  }
  #closeSecretBtn {
    background: #e74c3cbb;
  }
  #closeSecretBtn:hover {
    background: #c0392b;
  }
  #secretPanel button:not(#closeSecretBtn) {
    background: #2ecc40bb;
    color: white;
  }
  #secretPanel button:not(#closeSecretBtn):hover {
    background: #27ae60;
  }
  @media (max-width: 480px) {
    .container { width: 90vw; padding: 20px; }
    #text { font-size: 20px; min-height: 90px; }
    #input { height: 60px; font-size: 18px; padding: 15px 18px; }
    button { width: 150px; font-size: 18px; padding: 14px 0; }
    #secretInput { width: 90vw; bottom: 20px; left: 5vw; }
    #secretPanel { width: 90vw; left: 5vw; }
  }
</style>
</head>
<body>
  <main class="container" role="main" aria-label="Typing game container">
    <h1 id="stage" aria-live="polite">Stage: 1 / 20</h1>
    <div id="timer" aria-live="polite">Time: 120</div>
    <div class="progress-bar" aria-hidden="true"><div class="bar" id="bar"></div></div>
    <section id="text" aria-live="polite" aria-atomic="true"></section>
    <textarea id="input" aria-label="Typing input area" placeholder="Start typing here..." autofocus></textarea>
    <button id="restartBtn">Restart</button>
  </main>

  <input id="secretInput" aria-label="Secret code input" placeholder="Enter admin code..." autocomplete="off" spellcheck="false" />

  <section id="secretPanel" aria-hidden="true">
    <h2>Admin Panel</h2>
    <button id="autoTypeBtn" aria-label="Auto type button">AutoType</button>
    <button id="skipStageBtn" aria-label="Skip current stage">Skip Stage</button>
    <button id="restartBtnSecret" aria-label="Restart game">Restart Game</button>
    <button id="resetProgressBtn" aria-label="Reset progress to stage 1">Reset Progress</button>
    <button id="toggleTimerBtn" aria-label="Pause or resume timer">Pause Timer</button>
    <button id="toggleHighlightBtn" aria-label="Toggle highlighting of letters">Toggle Highlight</button>
    <input id="customTextInput" aria-label="Custom text to add" placeholder="Add custom text for next stage" />
    <button id="addCustomTextBtn" aria-label="Add custom text">Add Text</button>
    <button id="closeSecretBtn" aria-label="Close admin panel">Close</button>
  </section>

  <script>
    const stages = [
      `In the twilight of a serene evening, the sun dipped below the horizon painting the sky with hues of orange and crimson as gentle breezes whispered through the leaves.`,
      `A vast expanse of ancient forests stretched endlessly, where the songs of myriad birds intertwined with the rustling trees creating a symphony of nature’s purest music.`,
      `Through winding rivers and rugged mountains, the brave adventurers journeyed beyond the known realms seeking treasures hidden within enchanted caves guarded by mystical beasts.`,
      `The whispered legends spoke of a radiant crystal that held the power to heal all wounds and bestow eternal wisdom, guarded fiercely by shadows lurking in forgotten ruins.`,
      `As dawn broke over the sleepy village, golden rays illuminated cobblestone streets bustling with merchants, children’s laughter, and the scent of freshly baked bread wafting in the air.`,
      `Beneath the vast star-studded canvas of night, the ancient temple stood tall, its intricate carvings telling tales of gods and heroes long faded into legend but never forgotten.`,
      `The playwright penned an elaborate narrative filled with twists and revelations that challenged the audience’s perception of truth, reality, and illusion within the fleeting moments of performance.`,
      `Hidden within dusty tomes and scrolls lay secrets of lost civilizations, their profound knowledge waiting patiently for the curious minds to decipher and unlock forgotten mysteries.`,
      `Amid the chaotic storm, determined ships fought relentless waves, with every sailor grasping hope tightly as the beacon of the lighthouse promised safe passage through treacherous waters.`,
      `In realms where magic intertwined with technology, towering cities shimmered with light and sound, while inhabitants explored the delicate balance between ancient wisdom and futuristic innovation.`,
      `The chronicles of the timekeepers reveal stories of moments caught between the ticking seconds, where fate and destiny entwined in the narrowest margins of decision.`,
      `Surrounded by shimmering lakes and rolling hills, the village festival bloomed in vibrant colors and joyous sounds that echoed through the crisp air of early autumn.`,
      `With every stroke of the painter’s brush, an entire universe blossomed onto the canvas, rich with emotion, texture, and vivid storytelling concealed within pigment and light.`,
      `Scientists delved into the mysteries of the cosmos, uncovering patterns that challenge our understanding of space, time, and the very fabric that holds reality together.`,
      `The explorers ventured into forgotten temples, where ancient glyphs spoke a language only few could read, revealing secrets locked away by generations long past.`,
      `Melodies floated gently over the valley, carried by the wind and weaving through the hearts of all who listened, resurrecting forgotten memories and creating new dreams.`,
      `In the quiet solitude of the library, the aroma of aged paper and ink inspired countless journeys beyond the confines of the real into worlds imagined and unknown.`,
      `As the storm subsided, the first rays of sunlight pierced the clouds, casting golden light on the awakening city streets and renewing hope for a peaceful tomorrow.`,
      `The artisan's hands labored tirelessly, crafting intricate designs in wood and metal, each piece a symbol of tradition, skill, and the enduring spirit of creation.`,
      `Underneath the vast ocean waves, colorful reefs thrived, a bustling metropolis of aquatic life that paints an ever-changing portrait beneath the surface.`
    ];

    let currentStage = 0;
    let charEls = [];
    let timerInterval = null;
    let startTime = null;
    const timeLimit = 120; // 2 minutes
    let gameEnded = false;
    let autoTyping = false;
    let autoTypeIndex = 0;
    let autoTypeInterval = null;
    let timerPaused = false;
    let pausedElapsed = 0;
    let highlightsOn = true;

    const textEl = document.getElementById('text');
    const inputEl = document.getElementById('input');
    const stageEl = document.getElementById('stage');
    const timerEl = document.getElementById('timer');
    const barEl = document.getElementById('bar');
    const secretInput = document.getElementById('secretInput');
    const secretPanel = document.getElementById('secretPanel');
    const autoTypeBtn = document.getElementById('autoTypeBtn');
    const skipStageBtn = document.getElementById('skipStageBtn');
    const restartBtn = document.getElementById('restartBtn');
    const restartBtnSecret = document.getElementById('restartBtnSecret');
    const resetProgressBtn = document.getElementById('resetProgressBtn');
    const toggleTimerBtn = document.getElementById('toggleTimerBtn');
    const toggleHighlightBtn = document.getElementById('toggleHighlightBtn');
    const customTextInput = document.getElementById('customTextInput');
    const addCustomTextBtn = document.getElementById('addCustomTextBtn');
    const closeSecretBtn = document.getElementById('closeSecretBtn');

    function populateText(str) {
      textEl.innerHTML = '';
      charEls = [];
      str.split('').forEach(letter => {
        const span = document.createElement('span');
        span.innerText = letter;
        textEl.appendChild(span);
        charEls.push(span);
      });
    }

    function resetCharEls() {
      charEls.forEach(charEl => {
        charEl.classList.remove('correct');
        charEl.classList.remove('wrong');
      });
    }

    function startGame() {
      inputEl.value = '';
      gameEnded = false;
      autoTyping = false;
      if (autoTypeInterval) {
        clearInterval(autoTypeInterval);
        autoTypeInterval = null;
      }
      if (timerInterval) clearInterval(timerInterval);
      timerPaused = false;
      pausedElapsed = 0;
      toggleTimerBtn.textContent = "Pause Timer";
      if (currentStage >= stages.length) currentStage = 0;
      stageEl.innerText = `Stage: ${currentStage + 1} / ${stages.length}`;
      populateText(stages[currentStage]);
      barEl.style.width = '0%';
      timerEl.innerText = `Time: ${timeLimit}`;
      startTime = Date.now();
      timerInterval = setInterval(updateTimer, 100);
      inputEl.focus();
    }

    function endGame(success) {
      gameEnded = true;
      if (autoTypeInterval) {
        clearInterval(autoTypeInterval);
        autoTypeInterval = null;
      }
      clearInterval(timerInterval);
      setTimeout(() => {
        if (success) {
          alert(`Well Done! You finished stage ${currentStage + 1}.`);
          currentStage++;
          startGame();
        } else {
          alert("Time's up! Try again.");
          startGame();
        }
      }, 100);
    }

    function updateTimer() {
      if(timerPaused) return;
      let elapsed = Math.floor((Date.now() - startTime) / 1000);
      timerEl.innerText = `Time: ${timeLimit - elapsed}`;
      if ((timeLimit - elapsed) <= 0 && !gameEnded) {
        endGame(false);
      }
    }

    function updateProgressBar(percent) {
      barEl.style.width = `${percent}%`;
    }

    inputEl.addEventListener('input', () => {
      if (gameEnded || autoTyping) return;
      let val = inputEl.value;
      resetCharEls();
      let errorCount = 0;
      let currentText = stages[currentStage];
      let minLen = Math.min(val.length, currentText.length);
      for (let i = 0; i < minLen; i++) {
        if (val[i] === currentText[i]) {
          if (highlightsOn) {
            charEls[i].classList.add('correct');
          }
        } else {
          if (highlightsOn) {
            charEls[i].classList.add('wrong');
          }
          errorCount++;
        }
      }
      updateProgressBar((val.length / currentText.length) * 100);
      if (val.length === currentText.length && errorCount === 0) {
        endGame(true);
      }
    });

    secretInput.addEventListener('keydown', e => {
      if (e.key === 'Enter') {
        if (secretInput.value.trim() === 'BETTERTYPINGGAME09') {
          secretPanel.style.display = 'block';
          secretInput.value = '';
          secretInput.blur();
          secretPanel.setAttribute('aria-hidden', 'false');
        }
      }
    });

    autoTypeBtn.addEventListener('click', () => {
      if (autoTyping) return;
      autoTyping = true;
      inputEl.value = '';
      autoTypeIndex = 0;
      resetCharEls();

      autoTypeInterval = setInterval(() => {
        if (autoTypeIndex < stages[currentStage].length) {
          inputEl.value += stages[currentStage][autoTypeIndex];
          inputEl.dispatchEvent(new Event('input'));
          autoTypeIndex++;
        } else {
          clearInterval(autoTypeInterval);
          autoTyping = false;
          endGame(true);
        }
      }, 20);
    });

    skipStageBtn.addEventListener('click', () => {
      currentStage++;
      if (currentStage >= stages.length) currentStage = 0;
      startGame();
    });

    restartBtn.addEventListener('click', () => {
      currentStage = 0;
      startGame();
      secretPanel.style.display = 'none';
      secretPanel.setAttribute('aria-hidden', 'true');
    });

    restartBtnSecret.addEventListener('click', () => {
      currentStage = 0;
      startGame();
      secretPanel.style.display = 'none';
      secretPanel.setAttribute('aria-hidden', 'true');
    });

    resetProgressBtn.addEventListener('click', () => {
      currentStage = 0;
      alert('Progress reset to stage 1');
    });

    toggleTimerBtn.addEventListener('click', () => {
      if (timerPaused) {
        startTime = Date.now() - pausedElapsed * 1000;
        timerInterval = setInterval(updateTimer, 100);
        timerPaused = false;
        toggleTimerBtn.textContent = "Pause Timer";
      } else {
        if (timerInterval) {
          clearInterval(timerInterval);
        }
        pausedElapsed = Math.floor((Date.now() - startTime) / 1000);
        timerPaused = true;
        toggleTimerBtn.textContent = "Resume Timer";
      }
    });

    toggleHighlightBtn.addEventListener('click', () => {
      highlightsOn = !highlightsOn;
      if (!highlightsOn) {
        resetCharEls();
      } else {
        inputEl.dispatchEvent(new Event('input'));
      }
    });

    addCustomTextBtn.addEventListener('click', () => {
      const text = customTextInput.value.trim();
      if (text) {
        stages.splice(currentStage + 1, 0, text);
        alert('Added new custom text to stage ' + (currentStage + 2));
        customTextInput.value = '';
      }
    });

    closeSecretBtn.addEventListener('click', () => {
      secretPanel.style.display = 'none';
      secretPanel.setAttribute('aria-hidden', 'true');
      inputEl.focus();
    });

    window.onload = startGame;
  </script>
</body>
</html>